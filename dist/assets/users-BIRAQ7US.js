import{e as D,b as j,j as e,r as l,f as r,L,g as k,h as z,a as q,u as E,c as F,B as f,S as A,A as I,R as Q}from"./index-CLjbNnPZ.js";import{a as B,D as H,b as K,C as M}from"./dashboard-BJNh_bgE.js";import{q as O,A as P,C as S,f as $}from"./confirmation-dialog-DpqcRTkk.js";const G=()=>j.get("/users"),m=()=>O({queryKey:["users"],queryFn:G}),_=({queryConfig:a}={})=>D({...m(),...a}),h=({className:a,...s})=>e.jsx("nav",{role:"navigation","aria-label":"pagination",className:r("mx-auto flex w-full justify-center",a),...s});h.displayName="Pagination";const p=l.forwardRef(({className:a,...s},t)=>e.jsx("ul",{ref:t,className:r("flex flex-row items-center gap-1",a),...s}));p.displayName="PaginationContent";const o=l.forwardRef(({className:a,...s},t)=>e.jsx("li",{ref:t,className:r("",a),...s}));o.displayName="PaginationItem";const d=({className:a,isActive:s,size:t="icon",children:i,href:n,...c})=>e.jsx(L,{to:n,"aria-current":s?"page":void 0,className:r(k({variant:s?"outline":"ghost",size:t}),a),...c,children:i});d.displayName="PaginationLink";const N=({className:a,...s})=>e.jsxs(d,{"aria-label":"Go to previous page",size:"default",className:r("gap-1 pl-2.5",a),...s,children:[e.jsx(B,{className:"size-4"}),e.jsx("span",{children:"Previous"})]});N.displayName="PaginationPrevious";const y=({className:a,...s})=>e.jsxs(d,{"aria-label":"Go to next page",size:"default",className:r("gap-1 pr-2.5",a),...s,children:[e.jsx("span",{children:"Next"}),e.jsx(K,{className:"size-4"})]});y.displayName="PaginationNext";const x=({className:a,...s})=>e.jsxs("span",{"aria-hidden":!0,className:r("flex h-9 w-9 items-center justify-center",a),...s,children:[e.jsx(H,{className:"size-4"}),e.jsx("span",{className:"sr-only",children:"More pages"})]});x.displayName="PaginationEllipsis";const V=({totalPages:a,currentPage:s,rootUrl:t})=>{const i=n=>`${t}?page=${n}`;return e.jsx(h,{className:"justify-end py-8",children:e.jsxs(p,{children:[s>1&&e.jsx(o,{children:e.jsx(N,{href:i(s-1)})}),s>2&&e.jsx(o,{children:e.jsx(x,{})}),s>1&&e.jsx(o,{children:e.jsx(d,{href:i(s-1),children:s-1})}),e.jsx(o,{className:"rounded-sm bg-gray-200",children:e.jsx(d,{href:i(s),children:s})}),a>s&&e.jsx(o,{children:e.jsx(d,{href:i(s+1),children:s+1})}),a>s+1&&e.jsx(o,{children:e.jsx(x,{})}),s<a&&e.jsx(o,{children:e.jsx(y,{href:i(a)})})]})})},b=l.forwardRef(({className:a,...s},t)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:t,className:r("w-full caption-bottom text-sm",a),...s})}));b.displayName="Table";const g=l.forwardRef(({className:a,...s},t)=>e.jsx("thead",{ref:t,className:r("[&_tr]:border-b",a),...s}));g.displayName="TableHeader";const w=l.forwardRef(({className:a,...s},t)=>e.jsx("tbody",{ref:t,className:r("[&_tr:last-child]:border-0",a),...s}));w.displayName="TableBody";const X=l.forwardRef(({className:a,...s},t)=>e.jsx("tfoot",{ref:t,className:r("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...s}));X.displayName="TableFooter";const u=l.forwardRef(({className:a,...s},t)=>e.jsx("tr",{ref:t,className:r("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...s}));u.displayName="TableRow";const v=l.forwardRef(({className:a,...s},t)=>e.jsx("th",{ref:t,className:r("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s}));v.displayName="TableHead";const R=l.forwardRef(({className:a,...s},t)=>e.jsx("td",{ref:t,className:r("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...s}));R.displayName="TableCell";const J=l.forwardRef(({className:a,...s},t)=>e.jsx("caption",{ref:t,className:r("mt-4 text-sm text-muted-foreground",a),...s}));J.displayName="TableCaption";const W=({data:a,columns:s,pagination:t})=>a!=null&&a.length?e.jsxs(e.Fragment,{children:[e.jsxs(b,{children:[e.jsx(g,{children:e.jsx(u,{children:s.map((i,n)=>e.jsx(v,{children:i.title},i.title+n))})}),e.jsx(w,{children:a.map((i,n)=>e.jsx(u,{children:s.map(({Cell:c,field:C,title:T},U)=>e.jsx(R,{children:c?e.jsx(c,{entry:i}):`${i[C]}`},T+U))},(i==null?void 0:i.id)||n))})]}),t&&e.jsx(V,{...t})]}):e.jsxs("div",{className:"flex h-80 flex-col items-center justify-center bg-white text-gray-500",children:[e.jsx(P,{className:"size-16"}),e.jsx("h4",{children:"No Entries Found"})]}),Y=({userId:a})=>j.delete(`/users/${a}`),Z=({mutationConfig:a}={})=>{const s=z(),{onSuccess:t,...i}=a||{};return q({onSuccess:(...n)=>{s.invalidateQueries({queryKey:m().queryKey}),t==null||t(...n)},...i,mutationFn:Y})},ee=({id:a})=>{var n;const s=E(),{addNotification:t}=F(),i=Z({mutationConfig:{onSuccess:()=>{t({type:"success",title:"User Deleted"})}}});return((n=s.data)==null?void 0:n.id)===a?null:e.jsx(S,{icon:"danger",title:"Delete User",body:"Are you sure you want to delete this user?",triggerButton:e.jsx(f,{variant:"destructive",children:"Delete"}),confirmButton:e.jsx(f,{isLoading:i.isPending,type:"button",variant:"destructive",onClick:()=>i.mutate({userId:a}),children:"Delete User"})})},se=()=>{var t;const a=_();if(a.isLoading)return e.jsx("div",{className:"flex h-48 w-full items-center justify-center",children:e.jsx(A,{size:"lg"})});const s=(t=a.data)==null?void 0:t.data;return s?e.jsx(W,{data:s,columns:[{title:"First Name",field:"firstName"},{title:"Last Name",field:"lastName"},{title:"Email",field:"email"},{title:"Role",field:"role"},{title:"Created At",field:"createdAt",Cell({entry:{createdAt:i}}){return e.jsx("span",{children:$(i)})}},{title:"",field:"id",Cell({entry:{id:i}}){return e.jsx(ee,{id:i})}}]}):null},re=a=>async()=>{const s=m();return a.getQueryData(s.queryKey)??await a.fetchQuery(s)},ne=()=>e.jsx(M,{title:"Users",children:e.jsx(I,{forbiddenFallback:e.jsx("div",{children:"Only admin can view this."}),allowedRoles:[Q.ADMIN],children:e.jsx(se,{})})});export{re as clientLoader,ne as default};
